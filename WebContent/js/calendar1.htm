<html>

<style>
<!--
.DayN { font-family: Arial; font-size: 11px; background-color: rgb(256,256,256); color: rgb(0,0,0); font-weight: bold; text-align: center; vertical-align: middle; border: 2px solid rgb(256,256,256) }
.DayU { font-family: Arial; font-size: 11px; background-color: #7496CF; color: rgb(255,255,255); font-weight: bold; text-align: center; vertical-align: middle; border: 2px outset rgb(255,255,255) }
.DayD{ font-family: Arial; font-size: 11px; background-color: #DEEEF6; color: rgb(0,0,0); font-weight: bold; text-align: center; vertical-align: middle; border: 2px inset rgb(255,255,255) }
.WeekDay{ font-family: Arial; font-size: 11px; background-color: #BCCCD4; color: rgb(255,255,255); font-weight: bold; text-align: center; vertical-align: middle; border-left: 1px solid rgb(255,255,255); border-right: 1px solid rgb(255,255,255); border-top: 1px solid rgb(255,255,255) }
.WeekEnd{ font-family: Arial; font-size: 11px; background-color: #FFCCCC; color: rgb(255,255,255); font-weight: bold; text-align: center; vertical-align: middle; border-left: 1px solid rgb(255,255,255); border-right: 1px solid rgb(255,255,255); border-top: 1px solid rgb(255,255,255) }
.ArrowN{ font-family: Arial; font-size: 13px; background-color: #7496CF; color: rgb(255,255,255); font-weight: bold; text-align: center; vertical-align: middle; border: 2px solid rgb(128,128,128) }
.ArrowU{ font-family: Arial; font-size: 13px; background-color: #7496CF; color: rgb(255,255,255); font-weight: bold; text-align: center; vertical-align: middle; border: 2px outset rgb(255,255,255) }
.ArrowD{ font-family: Arial; font-size: 13px; background-color: #7496CF; color: rgb(255,255,255); font-weight: bold; text-align: center; vertical-align: middle; border: 2px inset rgb(255,255,255) }
.DateSelect{ font-family: Arial; font-size: 11px; background-color: rgb(256,256,256); font-weight: bold; text-align: right }
-->
</style>


<body topmargin="0" leftmargin="0" scroll="no" background="../images/bgk.gif">

<table border="0" cellpadding="0" cellspacing="0" width="22">
  <tr>
    <td  height="180">
      <table border="0" cellpadding="0" cellspacing="0" style="font-size: 11px; cursor: hand; background-color: rgb(256,256,256); border: 1px solid rgb(0,0,0)" id="tblCal" width="100%" height="100%" OnSelectStart="return false;">
  			<tr>
  			  <td align="center" bgcolor="#7E96A2" id="celBack" class="ArrowN" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&lt;</td>
  			  <td align="center" style="vertical-align: middle" id="celMonth" colspan="5"><table
  			  border="0" cellpadding="0" cellspacing="0" align="center">
  			    <tr>
  			      <td width="68">
  			        <div style="clip:rect(2,70,16,2); position:absolute; top:3px">
  			          <select name="selMonth" size="1" class="DateSelect" style="text-align: left;width:90"  ONCHANGE="selMonthYear();">
  			              <option value="January">一月</option>
  			              <option value="February">二月</option>
  			              <option value="March">三月</option>
  			              <option value="April">四月</option>
  			              <option value="May">五月</option>
  			              <option value="June">六月</option>
  			              <option value="July">七月</option>
  			              <option value="August">八月</option>
  			              <option value="September">九月</option>
  			              <option value="October">十月</option>
  			              <option value="November">十一月</option>
  			              <option value="December">十二月</option>
  			           </select>
  			        </div>
  			       </td>
  			      <td width="30">
  			        <div style="clip:rect(2,40,16,2); position:absolute; top:3px">
  			          <select name="selYear" size="1" class="DateSelect" style="text-align: left;width:60" ONCHANGE="selMonthYear();">
  			          </select>
  			        </div>
  			      </td>
  			    </tr>
  			  </table>
  			  </td>
  			  <td align="center" bgcolor="#7E96A2" id="celNext" class="ArrowN" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&gt;</td>
  			</tr>
  			<tr>
  			  <td align="center"
  			  style="vertical-align: middle; background-color: #FF8888; color: rgb(255,255,255)"
  			  width="14%" class="WeekEnd">日</td>
  			  <td align="center" style="vertical-align: middle" width="14%" class="WeekDay">一</td>
  			  <td align="center" style="vertical-align: middle" width="14%" class="WeekDay">二</td>
  			  <td align="center" style="vertical-align: middle" width="14%" class="WeekDay">三</td>
  			  <td align="center" style="vertical-align: middle" width="14%" class="WeekDay">四</td>
  			  <td align="center" style="vertical-align: middle" width="14%" class="WeekDay">五</td>
  			  <td align="center"
  			  style="vertical-align: middle; background-color: #FF8888; color: #ffffff"
  			  width="14%" class="WeekEnd">六</td>
  			</tr>
  			<tr>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d1"  onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d2"  onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d3"  onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d4"  onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d5"  onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d6"  onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d7"  onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			</tr>
  			<tr>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d8"  onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d9"  onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d10" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d11" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d12" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d13" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d14" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			</tr>
  			<tr>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d15" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d16" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d17" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d18" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d19" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d20" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d21" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			</tr>
  			<tr>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d22" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d23" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d24" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d25" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d26" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d27" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d28" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			</tr>
  			<tr>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d29" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d30" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d31" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d32" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d33" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d34" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d35" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			</tr>
  			<tr>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d36" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d37" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d38" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d39" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d40" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d41" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			  <td align="center" style="vertical-align: middle" class="DayN" width="14%" id="d42" onmouseover="raiseCel(this);"onmouseout="sinkCel(this);" onmousedown="mdCel(this);"onmouseup="muCel(this);">&nbsp;</td>
  			</tr>
			</table>
    </td>
  </tr>
  <tr>
    <td><input type="button" value="關閉視窗" name="cmdClose" style="WIDTH:200px" ONCLICK="window.parent.document.all('popCal').style.visibility = 'hidden';" ></td>
  </tr>
</table>

<p>
<script LANGUAGE="JavaScript" FOR="cal" EVENT="onscriptletevent(name,eventdata)">
	dateChange(eventdata);
</script>
<script language="JavaScript">
<!--

var dCurDate = "";
var objTemp;

var objCurrentTxt ;



//window.onload = initWindow;
window.onerror = doError;
//document.onmouseover = raiseCel;
//document.onmouseout = sinkCel;
//document.onmousedown = mdCel;
//document.onmouseup = muCel;

function doError() {
	alert(arguments[0]);
}

function initWindow(obj) {
  var dNow = new Date();
	setDateSelect();
	updateCal(dNow);
	displayMonthYear(dNow);
	if(navigator.appName == "Netscape")
  {
     var url = window.location.href;
     var iniDate = url.substr(url.indexOf("iniTime=") + 8);
     if (iniDate != "" && window.opener != null)
     {
         iniDate = window.opener.document.all(iniDate).value;
         setDate(iniDate);
     }
  }
  else
  {


     var currentDate = obj.value;

     //window.returnValue = window.dialogArguments;

     setDate(currentDate);

     //alert(window.parent.rrrjjj);
     //window.returnValue =window.parent.g_CurrentTxtValue_RJ;

     //setDate (window.parent.g_CurrentTxtValue_RJ);

  }

}

function dateChange(sValue) {
  if(navigator.appName == "Netscape")
  {
     var url = window.location.href;
     var iniDate = url.substr(url.indexOf("iniTime=") + 8);
     if (iniDate != ""&& window.opener != null)
     {
         window.opener.document.all(iniDate).value = window.opener.formatDate(sValue);

     }
  }
  else
  {
     objCurrentTxt.value = formatDate(sValue, 0);
     objCurrentTxt.focus();

  }
	//window.close();
	window.parent.document.all('popCal').style.visibility = 'hidden';
}

function setDate(sDate) {
	dCurDate = "";
	objTemp = "";
	var dNow = new Date(sDate);

	dCurDate = dNow;
	if (dNow == "NaN" || dNow == "Invalid Date") {dNow = new Date(); dCurDate = "";}

	displayMonthYear(dNow);
	updateCal(dNow);
}

function setDay(sDay) {
	sMonth = document.all.selMonth.options[document.all.selMonth.selectedIndex].value;
	sYear = document.all.selYear.value
	dateChange(sMonth + " " + sDay + ", " + sYear);
}

function displayMonthYear(dDate) {
	iYear = dDate.getFullYear();
	document.all.selYear.value = iYear;
	if (document.all.selYear.value == "")
	{
		objNewOpt = document.createElement("OPTION");
		objNewOpt.text = iYear;
		objNewOpt.value = iYear;
		if (iYear > parseInt(document.all.selYear.options[0].value)) iPos = 0;
			else iPos = document.all.selYear.options.length + 1;
		document.all.selYear.options.add(objNewOpt,iPos);
		document.all.selYear.value = iYear;
	}
	document.all.selMonth.selectedIndex = dDate.getMonth();
}

function selMonthYear() {
	dDate = new Date(document.all.selYear.value, document.all.selMonth.selectedIndex, 1);
	updateCal(dDate);
}

function setDateSelect() {
	dNow = new Date();
	iScrap = dNow.getFullYear();
	for (i=0; i<40; i++)
	{
		objNewOpt = document.createElement("OPTION");
		objNewOpt.text = (iScrap +35 - i);
		objNewOpt.value = (iScrap +35 - i);
		document.all.selYear.options.add(objNewOpt);
	}
}

function raiseCel(objItem) {
   //if(navigator.appName == "Netscape")
   //{
	 //    objItem = window.event.target;
	 //}
	 //else
	 //{
	 //    objItem = event.srcElement;
	 //}
	if (objItem.className == "DayN")
		if (objItem.innerHTML != "") objItem.className = "DayU";
	if (objItem.className == "ArrowN") objItem.className = "ArrowU";
}

function sinkCel(objItem) {
	//var objItem;
  // if(navigator.appName == "Netscape")
  // {
	//     objItem = window.event.target;
	// }
	// else
	// {
	//     objItem = event.srcElement;
	// }
	if (objItem.className == "DayU") objItem.className = "DayN";
	if (objItem.className == "ArrowU") objItem.className = "ArrowN";
}

function mdCel(sCel) {
	objTemp = "";
	 //var sCel;
   //if(navigator.appName == "Netscape")
   //{
	 //    sCel = window.event.target;
	 //}
	 //else
	 //{
	 //    sCel = event.srcElement;
	 //}
	if (sCel.className == "DayU") {sCel.className = "DayD"; objTemp = sCel;}
	if (sCel.className == "ArrowU") sCel.className = "ArrowD";
}

function muCel(sCel) {
	//var sCel;
  // if(navigator.appName == "Netscape")
  // {
	//     sCel = window.event.target;
	// }
	// else
	// {
	//     sCel = event.srcElement;
	// }
	if (sCel.className == "ArrowD")
	{
		sCel.className = "ArrowU";
		if (sCel.id == "celBack")
		{
			dDate = dateAdd("m", -1, new Date(document.all.selYear.value, document.all.selMonth.selectedIndex, 1));
			displayMonthYear(dDate);
			updateCal(dDate);
		}
		if (sCel.id == "celNext")
		{
			dDate = dateAdd("m", 1, new Date(document.all.selYear.value, document.all.selMonth.selectedIndex, 1));
			displayMonthYear(dDate);
			updateCal(dDate);
		}
	}
	if (sCel.className == "DayD") setDay(sCel.innerHTML);
	if (objTemp != "") objTemp.className = "DayN";
}

function updateCal(dDate) {
	iMonth = dDate.getMonth();
	iYear = dDate.getFullYear();
	iDay = dDate.getDate();

	dStart = new Date(iYear, iMonth, 1);
	dEnd = dateAdd("m", 1, dStart);

	iDays = dateDiff("d", dStart, dEnd);
	iStartDay = (dStart.getDay() + 1);

	for (i = 1;  i < 43; i++) {
		sScrap = "d" + i
		objItem = document.all[sScrap];
		if (objItem.className == "DayD") objItem.className = "DayN";

		if ((i < iStartDay) || ((i - iStartDay + 1) > iDays)) objItem.innerHTML = "";
				else objItem.innerHTML = (i - iStartDay + 1);
   }

	if (dCurDate != "")
		if ((dCurDate.getMonth() == dDate.getMonth()) && (dCurDate.getFullYear() == dDate.getFullYear()))
			document.all("d" + (iStartDay - 1 + dCurDate.getDate())).className = "DayD";
}

function dateAdd(sInterval, iNumber, dDate) {
	dTemp = new Date(dDate);
	if (dTemp == "NaN") dTemp = new Date();
	switch (sInterval) {
		case "s" :
			return new Date(Date.parse(dTemp) + (1000 * iNumber));
		case "n" :
			return new Date(Date.parse(dTemp) + (60000 * iNumber));
		case "h" :
			return new Date(Date.parse(dTemp) + (3600000 * iNumber));
		case "d" :
			return new Date(Date.parse(dTemp) + (86400000 * iNumber));
		case "w" :
			return new Date(Date.parse(dTemp) + ((86400000 * 7) * iNumber));
		case "m" :
			return new Date(dTemp.getFullYear(), (dTemp.getMonth()) + iNumber, dTemp.getDate());
		case "y" :
			return new Date((dTemp.getFullYear() + iNumber), dTemp.getMonth(), dTemp.getDate());
	}
}

function dateDiff(sInterval, dStart, dEnd) {
	dStart = new Date(dStart);
		if (dStart == "NaN") dStart = new Date();
	dEnd = new Date(dEnd);
		if (dEnd == "NaN") dEnd = new Date();
	switch (sInterval) {
		case "s" :
			return parseInt((Date.parse(dEnd) - Date.parse(dStart)) / 1000);
		case "n" :
			return parseInt((Date.parse(dEnd) - Date.parse(dStart)) / 60000);
		case "h" :
			return parseInt((Date.parse(dEnd) - Date.parse(dStart)) / 3600000);
		case "d" :
			iScrap = (Date.parse(dEnd) - Date.parse(dStart)) / 86400000
			iScrap = iScrap + .1
			return parseInt(iScrap);
		case "w" :
			return parseInt((Date.parse(dEnd) - Date.parse(dStart)) / (86400000 * 7));
		case "m" :
			return (dEnd.getMonth() - dStart.getMonth());
		case "y" :
			return (dEnd.getFullYear() - dStart.getFullYear());
	}
}
// -->
</script></p>
<script language = 'javascript'>
var sMon = new Array(12);
	sMon[0] = "Jan"
	sMon[1] = "Feb"
	sMon[2] = "Mar"
	sMon[3] = "Apr"
	sMon[4] = "May"
	sMon[5] = "Jun"
	sMon[6] = "Jul"
	sMon[7] = "Aug"
	sMon[8] = "Sep"
	sMon[9] = "Oct"
	sMon[10] = "Nov"
	sMon[11] = "Dec"



function calendar(t,left,top) {
	objCurrentTxt = t;
        left+=15;
        top+=15;
	var sPath = "../js/calendar1.htm";
	st = t.value;
        if(navigator.appName == "Netscape")
        {
            sPath += "?iniTime=" + t.name;
             strFeatures = "width=200px,height=205px,screenX=" + left + ",screenY=" + top + ",scrollbars=no,status=no,toolbar=no";
             sDate = window.open(sPath,"",strFeatures);




         }
          else
          {

             var point = fGetXY(t);
	     with (window.parent.document.all('popCal').style)
	     {
		left = point.x;
		right= point.y;
		top  = point.y+t.offsetHeight+1;

	     }
	     window.parent.document.all('popCal').style.visibility = 'visible';

	     initWindow(t);


             //strFeatures = "dialogWidth=206px;dialogHeight=234px; POSITION: absolute; dialogLeft: "+left+"; dialogTop:"+top+";scroll=no;status=no;toolbar=no;fullscreen=1;help=no;unadorned=yes;";

             //sDate = showModalDialog(sPath,st,strFeatures);
	     //      t.value = formatDate(sDate, 0);
          }


}


//RHETTJIANG 2005/08/22
function fGetXY(aTag)
{
  var oTmp = aTag;
  var pt = new Point(0,0);
  do {
  	pt.x += oTmp.offsetLeft;
  	pt.y += oTmp.offsetTop;
  	oTmp = oTmp.offsetParent;
  } while(oTmp.tagName!="BODY");
  return pt;
}

//RJ
function Point(iX, iY){
	this.x = iX;
	this.y = iY;
}


function JohnV2(t,t1,left,top)
{
	left+=15;
	top+=15;
	var sPath = "../js/calendar1.htm";
	st = t.value;

	if(navigator.appName == "Netscape")
	{
		sPath += "?iniTime=" + t.name;
		strFeatures = "width=200px,height=205px,screenX=" + left + ",screenY=" + top + ",scrollbars=no,status=no,toolbar=no";
		sDate = window.open(sPath,"",strFeatures);
	}
	else
	{
		strFeatures = "dialogWidth=206px;dialogHeight=234px; POSITION: absolute; dialogLeft: "+left+"; dialogTop:"+top+";scroll=no;status=no;toolbar=no;fullscreen=1;";
		sDate = showModalDialog(sPath,st,strFeatures);
		t.value = formatDate(sDate, 0);
		t1.value = formatDate(sDate, 0);
	}
}

function show_calendar(t,left,top) {
	var myframe=document.all("iframe");
	myframe.style.left=left-100;
	myframe.style.top=top+5;
	var sPath = "../js/calendar1.htm";
	var st = t.value;
	sDate = showModalDialog(sPath,st,"position: absolute; left: -500px; top: 222px;");
	t.value=formatDate(sDate, 0);



}

function checkDate(t) {
	dDate = new Date(t.value);
	if (dDate == "NaN") {t.value = ""; return;}

	iYear = dDate.getFullYear()

	if ((iYear > 1899)&&(iYear < 1950)) {

		sYear = "" + iYear + ""
		if (t.value.indexOf(sYear,1) == -1) {
			iYear += 100
			sDate = (dDate.getMonth() + 1) + "/" + dDate.getDate() + "/" + iYear
			dDate = new Date(sDate)
		}
	}



	t.value = formatDate(dDate);
}

function formatDate(sDate) {
	var sScrap = "";
	var dScrap = new Date(sDate);
	if (dScrap == "NaN") return sScrap;

	iDay = dScrap.getDate();
	iMon = dScrap.getMonth()+1;
	iYea = dScrap.getFullYear();
        if (iDay<10)
	  iDay="/0"+iDay;
	else
	  iDay="/"+iDay;
	if (iMon<10)
	  iMon="/0"+iMon;
	else
	  iMon="/"+iMon;

	sScrap = iYea + iMon  + iDay ;
	return sScrap;
}




</script>



</body>
</html>

